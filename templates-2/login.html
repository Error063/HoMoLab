<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <style>
        button{
            height: 50px;
            width: 150px;
        }
        *{
            margin: 50px auto 0;
        }
    </style>
    <script>
        function afterShowLoginPage() {
            pywebview.api.tologin().then(
                function (flag) {
                    if(flag['flag']){
                        document.getElementsByClassName('tologin')[0].setAttribute("style","display: none")
                        document.getElementsByClassName('getcookies')[0].setAttribute("style","display: block")
                    }else {
                        alert("尝试显示窗口失败，请关闭该窗口后再试")
                    }
                }
            )
        }
        function afterLoginSuccess() {
            var status = confirm("是否登录完毕？")
            if (status){
                pywebview.api.getcookies().then(
                    function (flag) {
                        console.log(flag['flag'])
                        if(flag['flag']){
                            document.getElementsByClassName('getcookies')[0].setAttribute("style","display: none")
                            document.getElementsByClassName('ableToClose')[0].setAttribute("style","display: block")
                        }else {
                            alert('尝试获取登录参数错误，请重新登录！')
                            document.getElementsByClassName('getcookies')[0].setAttribute("style","display: none")
                            document.getElementsByClassName('tologin')[0].setAttribute("style","display: block")
                        }
                    }
                )
            }
        }
    </script>
</head>
<body>
    <p><button class="tologin" onclick="afterShowLoginPage()" style="display: block">先点击我</button></p>
    <p><button class="getcookies" onclick="afterLoginSuccess()" style="display: none">登录完成后再点击我</button></p>
    <h1 class="ableToClose" style="display: none">现在可以关闭该页面了</h1>
</body>
</html>